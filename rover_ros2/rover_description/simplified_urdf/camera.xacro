<?xml version='1.0'?>
<robot name="rerassor" xmlns:xacro="http://www.ros.org/wiki/xacro">
    <!-- Macro to add a depth camera to a given parent link -->
    <xacro:macro name="rerassor_camera" params="camera_prefix parent x y z">
        <!-- Camera link and fixed optical frame -->
        <link name="${camera_prefix}_link">
            <inertial>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <mass value="${cameraMass}"/>
                <inertia ixx="0.0001" iyy="0.0001" izz="0.0001" ixy="0" ixz="0" iyz="0"/>
            </inertial>
            <collision>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <geometry>
                    <box size="${cameraSize} ${cameraSize} ${cameraSize}"/>
                </geometry>
            </collision>
            <visual>
                <origin xyz="0 0 0" rpy="0 0 0"/>
                <geometry>
                    <box size="${cameraSize} ${cameraSize} ${cameraSize}"/>
                </geometry>
                <material name="green"/>
            </visual>
        </link>
        <link name="${camera_prefix}_optical">
            <!-- no inertial, collision or visual: purely optical frame -->
        </link>
        <joint name="${camera_prefix}_joint" type="fixed">
            <parent link="${parent}"/>
            <child link="${camera_prefix}_link"/>
            <origin xyz="${x} ${y} ${z}" rpy="0 0 0"/>
        </joint>
        <joint name="${camera_prefix}_optical_joint" type="fixed">
            <parent link="${camera_prefix}_link"/>
            <child link="${camera_prefix}_optical"/>
            <!-- Rotate optical frame: +Z forward, +X right, +Y down -->
            <origin xyz="0 0 0" rpy="-1.5708 0 -1.5708"/>
        </joint>
        <!-- Gazebo sensor is defined in the main URDF to ensure it attaches to the optical link -->
    </xacro:macro>
</robot>
