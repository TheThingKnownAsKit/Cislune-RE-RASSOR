services:
  rosdev:
    build: .
    container_name: ros2_dev
    network_mode: "host"
    environment:
      - DISPLAY=${DISPLAY}
      - QT_X11_NO_MITSHM=1        # (optional, avoids some shared memory issues)
    volumes:
      - .:/workspaces/Cislune-RE-RASSOR:rw
      - /tmp/.X11-unix:/tmp/.X11-unix
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1        # or "all"
              capabilities: [gpu]
    cap_add:
      - SYS_NICE               # For real-time scheduling
    device_cgroup_rules:
      - 'c 4:* rmw'       # serial UARTS
      - 'c 166:* rmw'     # USB CDC & USB-Serial adapters
      - 'c 188:* rmw'
      - 'c 81:* rmw'      # all V4L2 cameras
      - 'c 189:* rmw'     # Generic USB